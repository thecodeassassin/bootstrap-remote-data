var $=jQuery;
/*
 *
 * Bootstrap remote data tabs plugin
 * Version 1.2.0
 *
 * Authors: 
 *  - Stephen Hoogendijk (TheCodeAssassin)
 *  - Ilia Shakitko <shakitko@gmail.com>
 *
 * Licensed under the GPLV2 license.
 *
 * @returns {{hasLoadingMask: boolean, load: Function, _executeRemoteCall: Function}}
 * @constructor
 */
var hasLoadingMask=(jQuery().mask?true:false),bootstrapVersion2=(jQuery().typeahead?true:false),tabShowEvent=(bootstrapVersion2?"show":"show.bs.tab"),accordionShowEvent=(bootstrapVersion2?"show":"show.bs.collapse"),defaultSettings={customLoadFn:null,loadFirstTab:true},customSettings;if(typeof bootstrapRemoteTabSettings!="undefined"){customSettings=$.extend({},defaultSettings,bootstrapRemoteTabSettings)}$(function(){var e=document.location.hash,b;if(e){var d=e.split("bs-tab-")[1],a=$("[data-toggle=tab][href*="+d+"]");if(a){a.click()}var c=$("[data-toggle=collapse][href="+e+"]");if(c){if(c[0]!=$("[data-toggle=collapse]:first")[0]){c.click()}}}b=$("[data-toggle=tab]:first, [data-toggle=collapse]:first");if(!customSettings.loadFirstTab&&!a){b.click()}});var RemoteTabs=function(a){var b={hasLoadingMask:false,settings:a,customLoadFn:a.customLoadFn,load:function(d){var c=this;c.hasLoadingMask=!!d;$("[data-toggle=tab], [data-toggle=collapse]").each(function(h,l){var s=$(l),m,p,q,e,n,g,j=false,f,o,i;if(typeof s!="undefined"){if(s.attr("href")){i=s.attr("href").split("#")[1];s.on("click",function(k){$(this).tab("show");window.location.hash="bs-tab-"+i;k.preventDefault()});if(s.is("[data-tab-url]")){e=s.attr("data-tab-url");m=$("#"+i);p=s.attr("data-tab-json")||[];q=s.attr("data-tab-callback")||null;n=s.attr("data-tab-delay")||null;g=(s.is("[data-tab-always-refresh]")&&s.attr("data-tab-always-refresh")=="true")||null;f=s;o=(s.attr("data-toggle")=="tab"?tabShowEvent:accordionShowEvent);if(p.length>0){try{p=$.parseJSON(p)}catch(r){console.log("Invalid json passed to data-tab-json");console.log(r)}}if(o==accordionShowEvent){j=m.hasClass("in");if(bootstrapVersion2){s=s.parent()}else{s=s.parents(".panel")}if(j){c._triggerChange(null,e,p,q,s,m,n,g,f)}}s.on(o,function(k){c._triggerChange(k,e,p,q,s,m,n,g,f)})}}}})},_triggerChange:function(g,c,k,l,m,h,j,f,d){var i=this;if(g){if(typeof g.target.hash!="undefined"){window.location.hash=g.target.hash}else{window.location.hash=d.prop("hash")}}if((!m.hasClass("loaded")||f)&&!m.hasClass("loading")){if(i.customLoadFn){i.customLoadFn(i,true,h)}if(i.hasLoadingMask&&!i.settings.custom){h.mask("Loading...")}m.addClass("loading");if(j){clearTimeout(window.timer);window.timer=setTimeout(function(){i._executeRemoteCall(c,k,l,m,h)},j)}else{i._executeRemoteCall(c,k,l,m,h)}}},_executeRemoteCall:function(e,h,c,d,g){var f=this;$.ajax({url:e,data:h||[],success:function(i){d.removeClass("loading");if(f.customLoadFn){f.customLoadFn(f,false,g)}if(f.hasLoadingMask){g.unmask()}if(i){if(typeof window[c]=="function"){window[c].call(null,i,d,g,h)}if(!d.hasClass("loaded")){d.addClass("loaded")}g.html(i)}},error:function(k,i,j){g.html("An error occured while loading the data: "+j);d.removeClass("loading");if(f.customLoadFn){f.customLoadFn(f,false,g)}if(f.hasLoadingMask){g.unmask()}}})}};b.load(hasLoadingMask);return b};var remoteTabsPluginLoaded=new RemoteTabs(customSettings);